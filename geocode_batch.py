import csv
import os
import sys
import time
import requests
from dotenv import load_dotenv

load_dotenv()

API_KEY = os.getenv("GOOGLE_MAPS_API_KEY")
if not API_KEY:
    raise RuntimeError("GOOGLE_MAPS_API_KEY が .env に設定されていません")

GEOCODE_URL = "https://maps.googleapis.com/maps/api/geocode/json"


def geocode_one(address: str, region: str = "jp", session: requests.Session | None = None) -> dict:
    # 京都府を補完（精度UP）
    query = address if ("京都" in address) else (address + " 京都府")

    params = {
        "address": query,
        "key": API_KEY,
        "region": region,
        "language": "ja",
    }

    http = session or requests
    r = http.get(GEOCODE_URL, params=params, timeout=15)
    data = r.json()

    status = data.get("status")
    if status != "OK":
        return {"address": address, "query": query, "status": status, "error": data.get("error_message")}

    top = data["results"][0]
    loc = top["geometry"]["location"]

    return {
        "address": address,
        "query": query,
        "status": status,
        "formatted_address": top.get("formatted_address"),
        "lat": loc["lat"],
        "lng": loc["lng"],
        "location_type": top["geometry"].get("location_type"),
        "place_id": top.get("place_id"),
    }


def geocode_many(addresses: list[str], sleep_sec: float = 0.12) -> list[dict]:
    # 空文字除去 + 前後空白除去
    cleaned = []
    for a in addresses:
        a = a.strip()
        if a:
            cleaned.append(a)

    if not cleaned:
        return []

    # 重複を消して API 呼び出し回数を削減（順序は維持）
    unique_addresses = list(dict.fromkeys(cleaned))
    cache: dict[str, dict] = {}

    print(
        f"[geocode] total={len(cleaned)} unique={len(unique_addresses)} "
        f"saved_calls={len(cleaned) - len(unique_addresses)}",
        file=sys.stderr,
    )

    with requests.Session() as session:
        for i, a in enumerate(unique_addresses, start=1):
            cache[a] = geocode_one(a, session=session)
            if i < len(unique_addresses):
                time.sleep(sleep_sec)  # 連打しすぎ防止
            if i % 100 == 0 or i == len(unique_addresses):
                print(f"[geocode] {i}/{len(unique_addresses)}", file=sys.stderr)

    # 元の件数・順序で返す（重複はキャッシュ結果を再利用）
    results = []
    for a in cleaned:
        results.append(dict(cache[a]))
    return results


if __name__ == "__main__":
    # ここに住所リストを貼る（住所1, 住所2, 住所3 方式でOK）
    addresses = [
        "京都市上京区智恵光院通一条下る新白水丸町462-17",

"岡崎最勝寺町13番地","小山北上総町49番地の2","椥辻西浦町1番地の8","太秦安井西裏町11番地の6","上桂森下町31番地の1","京町南七丁目35番地の1","醍醐高畑町30番地の1","醍醐高畑町30番地の1","醍醐高畑町30番地の1","醍醐高畑町30番地の1","醍醐高畑町30番地の1","醍醐高畑町30番地の1","醍醐高畑町30番地の1","醍醐高畑町30番地の1","醍醐高畑町30番地の1","久世築山町328番地","久世築山町328番地","久世築山町328番地","久世築山町328番地","久世築山町328番地","久世築山町328番地","下鴨半木町1番地の26","円山町 円山公園内","円山町 円山公園内","室町通蛸薬師下る山伏山町546番2","室町通蛸薬師下る山伏山町山553","京北矢代中町馬場谷道ノ上29-1ほか","粟田口鳥居町2番地の1","粟田口鳥居町2番地の1","西洞院通塩小路下る東塩小路町939番地","西木屋町通上ノ口上る梅湊町83番地の1","西木屋町通上ノ口上る梅湊町83番地の1","西木屋町通上ノ口上る梅湊町83番地の1","西木屋町通上ノ口上る梅湊町83番地の1","西木屋町通上ノ口上る梅湊町83番地の1","西木屋町通上ノ口上る梅湊町83番地の1","紫野北花ノ坊町18番地","紫野北花ノ坊町18番地","紫野北花ノ坊町18番地","岡崎最勝寺町2番地","岡崎最勝寺町1番地の2","鹿ケ谷高岸町3番地の2","鹿ケ谷高岸町3番地の2","鹿ケ谷高岸町3番地の2","田中玄京町149番地","田中玄京町149番地","田中玄京町149番地","田中馬場町20番地","西ノ京新建町12番地の34","三条通大橋東入2丁目下る巽町442番地の9","三条通大橋東入2丁目下る巽町442番地の9","三条通大橋東入2丁目下る巽町442番地の9","三条通大橋東入2丁目下る巽町442番地の9","三条通大橋東入2丁目下る巽町442番地の9","西之町１１１","上之町38番地","上之町38番地","上之町38番地","上之町38番地","吉祥院砂ノ町45番地","吉祥院砂ノ町45番地","吉祥院砂ノ町45番地","上鳥羽南唐戸町62番地の2","上鳥羽山ノ本町332番地","久世大築町61番地","久世大築町54番地の1","醍醐外山街道町21番地の21","醍醐外山街道町24番地の4","深草加賀屋敷町6番地の2","深草加賀屋敷町6番地の2","深草加賀屋敷町6番地の2","竹田醍醐田町41番地","深草加賀屋敷町24番地の26","東洞院通六角下る御射山町262番地","東洞院通六角下る御射山町262番地","東洞院通六角下る御射山町262番地","紫野西御所田町56","紫野西御所田町56","紫野西御所田町56","竹鼻四丁野町42番地","西九条南田町72番地","西九条南田町72番地","深草池ノ内町13","紫野大徳寺町44番地の1","広河原杓子屋町98番地","樫原塚ノ本町1番地","西七条南衣田町42番地の3","久世上久世町262番地","唐橋経田町39番地","京北下中町東石原","京北宮町宮野80-1","京北細野町東ノ垣内10-2","京北周山町上ノ段16-2ほか","京北周山町明ケ市","京北中地町蛸谷口90","京北比賀江町院谷ほか","周山町下台5-1","太秦京ノ道町13番地の10","松尾鈴川町65番地","松尾鈴川町65番地","桂南巽町88番地","御陵大枝山町三丁目13番地1","御陵峰ケ堂町二丁目1-346","大枝北沓掛町七丁目9番13","大原野灰方町445番地の2","大原野灰方町445番地の2","大原野灰方町445番地の2","羽束師志水町73番地の3","久我御旅町3番地の3","下板橋町610番地","大和町568番4","淀水垂町","久世大築町40番地","醍醐外山街道町27番地の2","二条通堀川西入二条城町541番地","二条通堀川西入二条城町541番地","二条通堀川西入二条城町541番地","二条通堀川西入二条城町541番地","二条通堀川西入二条城町541番地","二条通堀川西入二条城町541番地","二条通堀川西入二条城町541番地","二条通堀川西入二条城町541番地","二条通堀川西入二条城町541番地","二条通堀川西入二条城町541番地","二条通堀川西入二条城町541番地","二条通堀川西入二条城町541番地","二条通堀川西入二条城町541番地","二条通堀川西入二条城町541番地","二条通堀川西入二条城町541番地","二条通堀川西入二条城町541番地","二条通堀川西入二条城町541番地","二条通堀川西入二条城町541番地","二条通堀川西入二条城町541番地","二条通堀川西入二条城町541番地","二条通堀川西入二条城町541番地","二条通堀川西入二条城町541番地","南禅寺草川町31番地","南禅寺草川町31番地","南禅寺草川町31番地","南禅寺草川町31番地","岩倉上蔵町100番地","岩倉上蔵町100番地","岩倉上蔵町100番地","岩倉上蔵町100番地","岩倉上蔵町100番地","末丸町284","末丸町284","祇園町北側627番地","桃山町大蔵","桃山町大蔵","桃山町大蔵","今町659番地の1","紫野雲林院町44番地の1","紫野雲林院町44番地の1","紫野雲林院町44番地の1","紫野雲林院町44番地の1","紫野雲林院町44番地の1","高野西開町5番地","高野西開町5番地","高野西開町5番地","高野西開町5番地","高野西開町5番地","岩倉下在地町16番地","竹鼻四丁野町34番地の1","竹鼻四丁野町34番地の1","竹鼻四丁野町34番地の1","竹鼻四丁野町34番地の1","竹鼻四丁野町34番地の1","竹鼻四丁野町34番地の1","新町通松原下る富永町110番地の1","新町通松原下る富永町110番地の1","新町通松原下る富永町110番地の1","新町通松原下る富永町110番地の1","新町通松原下る富永町110番地の1","新町通松原下る富永町110番地の1","吉祥院池田町1番地","吉祥院池田町1番地","山田大吉見町20番地の3","向島二ノ丸町151番地の35","石田西ノ坪1番地の2","石田西ノ坪1番地の2","石田西ノ坪1番地の2","石田西ノ坪1番地の2","岡崎法勝寺町岡崎公園内","岡崎法勝寺町岡崎公園内","岡崎法勝寺町岡崎公園内","今出川通大宮東入元伊佐町265番地の1","今出川通大宮東入元伊佐町265番地の1","今出川通大宮東入元伊佐町265番地の1","寺町通荒神口下る松蔭町138番地の1","岡崎法勝寺町岡崎公園内","岡崎法勝寺町岡崎公園内","岡崎法勝寺町岡崎公園内","岡崎法勝寺町岡崎公園内","岡崎法勝寺町岡崎公園内","岡崎法勝寺町岡崎公園内","岡崎法勝寺町岡崎公園内","岡崎法勝寺町岡崎公園内","岡崎法勝寺町岡崎公園内","岡崎法勝寺町岡崎公園内","岡崎法勝寺町岡崎公園内","岡崎法勝寺町岡崎公園内","岡崎法勝寺町岡崎公園内","岡崎法勝寺町岡崎公園内","岡崎法勝寺町岡崎公園内","岡崎法勝寺町岡崎公園内","岡崎法勝寺町岡崎公園内","岡崎法勝寺町岡崎公園内","岡崎法勝寺町岡崎公園内","清水二丁目205-5","西九条菅田町7番地","深草池ノ内町13番地","深草池ノ内町13番地","御幸町通仏光寺下る橘町437","御幸町通仏光寺下る橘町437","御幸町通仏光寺下る橘町437","紫野花ノ坊町23番地の1","烏丸通御池上る 元龍池小学校","烏丸通御池上る 元龍池小学校","烏丸通御池上る 元龍池小学校","烏丸通御池上る 元龍池小学校","下之町6番地の3","大枝北福西町二丁目300番地3","久我東町216番地","久我東町216番地","久我東町216番地","聚楽廻松下町9番地の2","聚楽廻松下町9番地の2","聚楽廻松下町9番地の2","竹鼻竹ノ街道町92番地","竹鼻竹ノ街道町92番地","竹鼻竹ノ街道町92番地","竹鼻竹ノ街道町92番地","壬生仙念町30番地の2","西京極新明町29番地","西京極新明町29番地","西京極新明町29番地","西京極新明町29番地","西京極新明町29番地","西京極徳大寺団子田町64番地","横大路下ノ坪1番地","横大路下ノ坪1番地","横大路下ノ坪1番地","横大路下ノ坪1番地","横大路下ノ坪1番地","横大路下ノ坪1番地","横大路下ノ坪1番地","横大路下ノ坪1番地","横大路下ノ坪1番地","横大路下ノ坪1番地","松ケ崎東池ノ内町ほか","松ケ崎東池ノ内町ほか","松ケ崎東池ノ内町ほか","松ケ崎東池ノ内町ほか","松ケ崎東池ノ内町ほか","松ケ崎東池ノ内町ほか","松ケ崎平田町ほか","松ケ崎平田町ほか","西京極新明町1番地","西京極新明町1番地","西京極新明町1番地","西京極新明町1番地","田中玄京町44番地の2","西ノ京北小路町4番地","椥辻西浦町1番地12","川端町13番地","川端町13番地","川端町13番地","川端町13番地","吉祥院砂ノ町47番地","吉祥院砂ノ町47番地","吉祥院砂ノ町47番地","久世大築町36番地","上桂今井町131番地","醍醐辰巳町4番地の1","醍醐辰巳町4番地の1","深草大亀谷五郎太町23番地","竹田醍醐田町17番地の6","京北宮町宮野80-1","聖護院円頓美町46番地の2","聖護院円頓美町46番地の2","聖護院円頓美町46番地の2","聖護院円頓美町46番地の2","聖護院円頓美町46番地の2","聖護院円頓美町46番地の2","聖護院円頓美町46番地の2","聖護院円頓美町46番地の2","聖護院円頓美町46番地の2","西京極新明町32番地","桃山町大蔵地内","桃山町大蔵地内","一乗寺御祭田町1番地","一乗寺御祭田町1番地","一乗寺御祭田町1番地","岡崎最勝寺町63番地","岡崎最勝寺町63番地","岡崎最勝寺町63番地","岡崎最勝寺町63番地","岩倉忠在寺町","岩倉忠在寺町","西ノ京船塚町1番地","西ノ京船塚町1番地","西ノ京船塚町1番地","西ノ京船塚町1番地","勧修寺東金ケ崎","東野八反畑町41番地の4","吉祥院新田下ノ向町","吉祥院新田下ノ向町","吉祥院新田下ノ向町","吉祥院新田下ノ向町","吉祥院新田下ノ向町","吉祥院新田下ノ向町","吉祥院新田下ノ向町","吉祥院新田下ノ向町","上鳥羽仏現寺町12番地","東九条下殿田町69番地","東九条下殿田町69番地","東九条下殿田町69番地","東九条下殿田町69番地","東九条下殿田町69番地","東九条下殿田町69番地","西院日照町","西院日照町","西院日照町","西院日照町","牛ケ瀬車ケ瀬","大枝東新林町二丁目","大枝東新林町二丁目","大枝東新林町二丁目","大枝東新林町二丁目","下鳥羽六反長町","下鳥羽六反長町","下鳥羽六反長町","桃山泰長老町","桃山泰長老町","花脊八桝町250番地","花脊八桝町250番地","京北下宇津町向ヒ山","京北下宇津町向ヒ山","京北下宇津町向ヒ山","京北下宇津町向ヒ山","京北下宇津町向ヒ山","京北下宇津町向ヒ山","京北下宇津町向ヒ山","京北下宇津町向ヒ山","太秦中山町29番地","太秦中山町29番地","日野船尾2番地","日野船尾2番地","小塩町初川口ほか","雲ケ畑中津川町28番地","雲ケ畑中津川町28番地","雲ケ畑中津川町28番地","花脊八桝町","静市静原町1172","静市静原町1172","静市静原町1172","朱雀分木町80番地","朱雀分木町80番地","朱雀分木町80番地","朱雀分木町80番地","朱雀分木町80番地","朱雀分木町80番地","朱雀分木町80番地","朱雀分木町80番地","朱雀分木町80番地","朱雀分木町80番地","朱雀分木町80番地","朱雀分木町80番地","朱雀分木町80番地","朱雀分木町80番地","朱雀分木町80番地","朱雀分木町80番地","朱雀分木町80番地","朱雀分木町80番地","朱雀分木町80番地","朱雀分木町80番地","朱雀分木町80番地","朱雀分木町80番地","朱雀分木町80番地","朱雀分木町80番地","朱雀分木町80番地","吉祥院石原東之口町2番地","吉祥院石原東之口町2番地","岡崎成勝寺町9番地の1","京北周山町上寺田1-1","京北周山町上寺田1-1","京北宮町宮野93","安朱桟敷町23番地","安朱桟敷町23番地","安朱桟敷町23番地","安朱桟敷町23番地","竹鼻竹ノ街道町91番地","竹鼻竹ノ街道町91番地","竹鼻竹ノ街道町91番地","竹鼻竹ノ街道町91番地","久多下之町411番地","久多下之町411番地","京北塔町中筋浦","京北比賀江町院谷6","三軒町65","田中飛鳥井町40番地","田中飛鳥井町40番地","田中飛鳥井町40番地","下鴨貴船町62番地","勧修寺西栗栖野町225番地","勧修寺西栗栖野町225番地","新町通七条下る東塩小路町590-10","花園木辻南町12-11","嵯峨折戸町28番地9","嵯峨折戸町28番地9","嵯峨折戸町28番地9","大枝沓掛町13-6","大枝沓掛町13-6","大枝沓掛町13-6","大枝沓掛町13-6","大枝沓掛町13-6","大枝沓掛町13-6","大枝沓掛町13-6","大枝沓掛町13-6","大枝沓掛町13-6","大枝沓掛町13-6","大枝沓掛町13-6","大枝沓掛町13-6","大枝沓掛町13-6","大枝沓掛町14-26,14-27,14-197","大枝沓掛町13-6","大枝沓掛町13-6","大枝沓掛町13-6","大枝沓掛町13-6","大枝沓掛町13-6","大枝沓掛町13-6","大枝沓掛町13-6","大枝沓掛町13-6","大枝沓掛町13-6","大枝沓掛町13-6","大枝沓掛町13-6","大枝沓掛町13-6","大枝沓掛町13-6","大枝沓掛町13-6","大枝沓掛町13-6","大枝沓掛町13-6","大枝沓掛町13-6","大枝沓掛町13-6","大枝沓掛町13-6","大枝沓掛町13-6","大枝沓掛町13-6","大枝沓掛町13-6","大枝沓掛町13-6","大枝沓掛町13-6","大枝沓掛町13-6","大枝沓掛町13-6","大枝沓掛町13-6","河原町通松原上る二丁目富永町344番地","河原町通松原上る二丁目富永町344番地","志摩市大王町船越231番地","志摩市大王町船越231番地","志摩市大王町船越231番地","志摩市大王町船越231番地","志摩市大王町船越231番地","志摩市大王町船越231番地","志摩市大王町船越231番地","志摩市大王町船越231番地","志摩市大王町船越231番地","志摩市大王町船越231番地","志摩市大王町船越231番地","志摩市大王町船越231番地","志摩市大王町船越231番地","志摩市大王町船越231番地","志摩市大王町船越231番地","志摩市大王町船越231番地","志摩市大王町船越231番地","志摩市大王町船越231番地","志摩市大王町船越231番地","志摩市大王町船越231番地","志摩市大王町船越231番地","花脊別所町399番地","花脊別所町399番地","花脊別所町399番地","花脊別所町399番地","花脊別所町399番地","花脊別所町399番地","花脊別所町399番地","花脊別所町399番地","花脊別所町399番地","花脊別所町399番地","花脊別所町399番地","花脊別所町399番地","花脊別所町399番地","花脊別所町399番地","花脊別所町399番地","花脊別所町399番地","花脊別所町399番地","東洞院姉小路下る曇華院前町706","西洞院通下立売下る東裏辻町402番地","西洞院通下立売下る東裏辻町402番地","花背大布施町117，118，119","花脊八桝町65-1","広河原杓子屋町98番地","広河原杓子屋町194番地","広河原杓子屋町194番地","京北周山町上代29-1","京北細野町東ノ垣内7-1","京北周山町上代29-1","京北周山町上植代8","嵯峨越畑南ノ町32-2","嵯峨越畑南ノ町32-2","嵯峨越畑南ノ町32-2","嵯峨水尾宮ノ脇町32-2","嵯峨樒原若宮下町17番地","花背大布施町364-1","花背大布施町117，118，119","西京極宮ノ東町","西京極葛野町2","西院日照町１","大津市御殿浜130-13","鹿ケ谷高岸町2番地の1","田中馬場町77番地","西ノ京新建町12番地","三条大橋東三丁目下る教業町696番地","屋形町6番地の1","吉祥院這登東町47番地","上鳥羽山ノ本町38番地","久世大築町66番地","醍醐外山街道町21番地の11","竹田狩賀町131番地","深草大亀谷岩山町48番地の1","深草大亀谷岩山町48番地の1","深草大亀谷岩山町48番地の1","桂艮町1番地の2","桂艮町1番地の2","桂艮町1番地の2","桂艮町1番地の2","釜座通丸太町上る梅屋町174-3","上花山旭山町19番地の3","上花山旭山町19番地の3","上花山旭山町19番地の3","上花山旭山町19番地の3","大北山蓮ケ谷町2番地の1","深草石峰寺山町","深草石峰寺山町","深草石峰寺山町","粟田口大日山町","粟田口大日山町","粟田口大日山町","今熊野日吉町","今熊野日吉町","御室住吉山町","西九条南田町1番地の2","西九条南田町1番地の2","西九条南田町1番地の2","紫野上御興町23番地の1","鹿ケ谷高岸町2-2","田中馬場町74番地","西ノ京北小路町17番地の2","久世大藪町196番地の1","深草加賀屋敷町14-16","醍醐外山街道町21","久多下の町203","上之町38番地","上之町38番地","上之町38番地","上鳥羽山ノ本町60番地","上鳥羽山ノ本町60番地","上鳥羽山ノ本町60番地","嵯峨水尾宮ノ脇町10","西ノ京中保町1番地の4","四条通大宮西入錦大宮町116番地先","平野上柳町28番地の24","堀川通寺之内上る二丁目下天神町650番地の1","堀川通寺之内上る二丁目下天神町650番地の1","堀川通寺之内上る二丁目下天神町650番地の1","御前通一条下る東竪町132番地の1","御前通一条下る東竪町132番地の1","御前通一条下る東竪町132番地の1","日暮通下立売上る西入分銅町556番","高野蓼原町47番地の5","高野蓼原町47番地の5","高野蓼原町47番地の5","山端柳ケ坪町18番地","山端柳ケ坪町18番地","山端柳ケ坪町18番地","御池通柳馬場東入東八幡町579番地","御池通柳馬場東入東八幡町579番地","御池通柳馬場東入東八幡町579番地","御池通柳馬場東入東八幡町579番地","御池通柳馬場東入東八幡町579番地","御池通柳馬場東入東八幡町579番地","西ノ京東中合町2番地","西ノ京東中合町2番地","西ノ京東中合町2番地","西ノ京東中合町2番地","西ノ京東中合町2番地","三条通古川町東入分木町80番地の2","三条通古川町東入分木町80番地の2","三条通古川町東入分木町80番地の2","渋谷通本町東入四丁目鐘鋳町415番地の4","渋谷通本町東入四丁目鐘鋳町415番地の4","渋谷通本町東入四丁目鐘鋳町415番地の4","日ノ岡朝田町53番地の11","日ノ岡朝田町53番地の11","日ノ岡朝田町53番地の11","西野大手先町2-1","西野大手先町2-1","西野大手先町2-1","川田土仏26番地","栗栖野打越町17番地","栗栖野打越町17番地","栗栖野打越町17番地","花屋町通室町西入乾町292","花屋町通室町西入乾町292","花屋町通室町西入乾町292","花屋町通室町西入乾町292","西新屋敷中之町103番地の2","西新屋敷中之町103番地の2","西新屋敷中之町103番地の2","東九条東札辻町6番地の1","東九条東札辻町6番地の1","東九条東札辻町6番地の1","吉祥院砂ノ町50番地","吉祥院砂ノ町50番地","吉祥院砂ノ町50番地","西院上今田町18番地の3","西院上今田町18番地の3","西院上今田町18番地の3","西京極葛野町3番地","西京極葛野町3番地","西京極葛野町3番地","西京極葛野町3番地","紙子屋町544","紙子屋町544","紙子屋町544","紙子屋町544","紙子屋町544","紙子屋町544","北端町44-7","北端町44-7","北端町44-7","北端町44-7","醍醐辰巳町12-1","醍醐辰巳町12-1","醍醐辰巳町12-1","醍醐辰巳町12-1","上賀茂馬ノ目町10番地の1","上賀茂馬ノ目町10番地の1","上賀茂馬ノ目町10番地の1","上賀茂馬ノ目町10番地の1","小川通今出川下る西入東今町375番地","小川通今出川下る西入東今町375番地","小川通今出川下る西入東今町375番地","小川通今出川下る西入東今町375番地","蛸薬師通油小路東入元本能寺南町346番地","蛸薬師通油小路東入元本能寺南町346番地","蛸薬師通油小路東入元本能寺南町346番地","蛸薬師通油小路東入元本能寺南町346番地","蛸薬師通油小路東入元本能寺南町346番地","東九条西岩本町1-1","東九条西岩本町1-1","東九条西岩本町1-1","東九条西岩本町1-1","下津林東大般若町32","下津林東大般若町32","下津林東大般若町32","下津林東大般若町32","下津林東大般若町32","下津林東大般若町32","今小路通御前東入西今小路町797番地","今小路通御前東入西今小路町797番地","今小路通御前東入西今小路町797番地","今小路通御前東入西今小路町797番地","久世中久世町五丁目19番地の1","久世中久世町五丁目19番地の1","久世中久世町五丁目19番地の1","久世中久世町五丁目19番地の1","太秦森ケ前町22番地の3","太秦森ケ前町22番地の3","太秦森ケ前町22番地の3","上桂前田町29番地の2","上桂前田町29番地の2","上桂前田町29番地の2","上桂前田町29番地の2","壬生坊城町48番地の3 ＵＲ都市機構壬生坊城第二団地4棟1階","椥辻西浦町41番地の107","吉祥院西定成町32番地","吉祥院西定成町32番地","吉祥院西定成町32番地","鳴滝宅間町14番地の2","久多下の町203番地","吉田近衛町26番地の72","吉田近衛町26番地の72","吉田近衛町26番地の72","吉田近衛町26番地の72","壬生坊城町19-4","壬生坊城町19-4","壬生坊城町19-4","壬生坊城町19-4","吉祥院西定成町35","吉祥院西定成町34","太秦森ケ前町21-10","太秦森ケ前町21-10","太秦森ケ前町21-10","桂徳大寺北町81","醍醐辰巳町6","横大路千両松町277番地","横大路千両松町277番地","横大路千両松町277番地","横大路千両松町277番地","大原野上里南ノ町38番地の2","壬生仙念町30番地","壬生仙念町30番地","壬生仙念町30番地","壬生仙念町30番地","壬生仙念町30番地","高野玉岡町5番地","高野玉岡町5番地","上鳥羽塔ノ森上河原37-4","紫野上築山町30番地1","竹屋町通千本東入主税町910番地の25","竹屋町通千本東入主税町910番地の25","竹屋町通千本東入主税町910番地の25","竹屋町通千本東入主税町910番地の25","深草加賀屋敷町24番地の13","深草加賀屋敷町24番地の26","深草西浦町65-1","京北下中町柿木通6番地の3","紫野北花ノ坊町23番地","寺町通今出川上る五丁目鶴山町5番地の6","田中玄京町151番地","西ノ京新建町1番地","聚楽廻松下町9番地の4","聚楽廻松下町9番地の4","聚楽廻松下町9番地の4","花見小路通古門前上る巽町467","三条大橋東三丁目下る長光町621番地","西九条春日町49番地","西九条南田町9番地","西九条南田町9番地","西九条南田町9番地","西九条南田町9番地","西九条南田町9番地","久世大築町50番地","久世大築町47番地の2","京北井戸町丸山110番地","京北井戸町丸山110番地","京北井戸町丸山110番地","京北下弓削町狭間谷6番地の1","京北五本松町西山24番地の3","竹田狩賀町153番地の1","竹田狩賀町153番地の1","醍醐外山街道町21番地の58","醍醐外山街道町21番地の58","京北細野町東ノ垣内9番地の1","上賀茂烏帽子ケ垣内町24番地","大宮薬師山東町13番地の17","大宮西野山町41番地","紫竹下園生町26番地","室町通上立売上る東入柳図子町301番地","吉田中阿達町39番地の15","岡崎入江町8番地","浄土寺真如町155番地の2","北白川上別当町39番地の5","田中玄京町30番地","下鴨北野々神町26番地","下鴨北野々神町26番地","下鴨北野々神町26番地","上高野松田町5番地","一乗寺燈籠本町26番地","一乗寺里ノ西町34番地","松ケ崎小竹薮町32番地の3","松ケ崎小竹薮町32番地の3","静市市原町254番地の2","岩倉忠在地町215番地の2","岩倉忠在地町215番地の2","岩倉北四ノ坪町35番地","西ノ京北小路町5番地","西ノ京南大炊御門町33番地","壬生松原町19番地の2","今熊野日吉町48番地の34","竹鼻四丁野町42番地の3","厨子奥苗代元町31番地","西野櫃川町27番地の3","四ノ宮神田町26番地","音羽森廻リ町34番地の5","小野蚊ケ瀬町15番地","西野山中臣町29番地の36 折上神社内","西野山欠ノ上町65番地の10","西七条西石ケ坪町5番地","唐橋西寺町65番地","東九条南山王町5番地の5","東九条南山王町5番地の5","東九条南山王町5番地の5","吉祥院三ノ宮町106番地","吉祥院西定成町35番地","上鳥羽南唐戸町28番地","久世大築町50番地の1","嵯峨野秋街道町35番地の1","山ノ内宮脇町12番地の2","西京極火打畑町6番地の1","西京極西池田町13番地の6","梅津中村町35番地の5","梅津開キ町18番地","梅津開キ町18番地","嵯峨広沢御所ノ内町21番地の3","花園天授ケ岡町3番地の15","桂上野西町273番地","桂徳大寺南町2番地","下津林東般若町44番地","下津林東般若町44番地","樫原山路11番地の10","嵐山東海道町47番地の1","大枝塚原町4番地の63","大原野上里北ノ町","大和町568番地","大和町568番地","西柳町577番地","向島津田町91番地の5","桃山町正宗52番地の6","桃山町伊庭16番地","醍醐西大路町75番地の1","醍醐東合場町27番地の8","日野林49番地の12","深草池ノ内町2番地","竹田醍醐田町17番地の5","横大路柿ノ本町3番地の5","納所薬師堂27番地","久我東町1番地の39","久我東町209番地","羽束師志水町138番地の6","紫野郷之上町36番地","御前通今出川上る鳥居前町671番地","大和大路通七条下る5丁目下池田町527番地","桂市ノ前町31番地","東九条松ノ木町6番地","太秦桂ケ原町9番地1","間之町通竹屋町下る楠町601番地の1","三条大橋東入二丁目若竹町422番地の5","京北周山町下寺田1-1","寺町通御池上る上本能寺前町488番地","紫野東御所田町33番地の1","紫野東御所田町33番地の1","紫野東御所田町33番地の1","紫野東御所田町33番地の1","紫野東御所田町33番地の1","今出川通室町西入堀出シ町285番地","今出川通室町西入堀出シ町285番地","松ケ崎堂ノ上町7-2","松ケ崎堂ノ上町7-2","松ケ崎堂ノ上町7-2","松ケ崎堂ノ上町7-2","西堀川通御池下る西三坊堀川町521番地","西堀川通御池下る西三坊堀川町521番地","西堀川通御池下る西三坊堀川町521番地","清水五丁目130-6","清水五丁目130-6","清水五丁目130-6","清水五丁目130-6","清水五丁目130番地の8","清水五丁目130番地の8","清水五丁目130番地の8","清水五丁目130番地の8","清水五丁目130番地の8","清水五丁目130番地の8","椥辻池尻町14番地の2","椥辻池尻町14番地の2","椥辻池尻町14番地の2","椥辻池尻町14番地の2","椥辻池尻町14番地の2","椥辻池尻町14番地の2","椥辻池尻町14番地の2","西洞院通塩小路上る東塩小路町608番地の8","西九条南田町1番地の3","太秦下刑部町12番地","太秦下刑部町12番地","太秦下刑部町12番地","太秦下刑部町12番地","上桂森下町25番地の1","上桂森下町25番地の1","鷹匠町39番地の2","鷹匠町39番地の2","鷹匠町39番地の2","鷹匠町39番地の2","大原野東境谷町二丁目1番地の2","大原野東境谷町二丁目1番地の2","大原野東境谷町二丁目1番地の2","大原野東境谷町二丁目1番地の2","深草向畑町93番地の1","深草向畑町93番地の1","醍醐大構町28番地","醍醐大構町28番地","醍醐大構町28番地","小野下ノ町100番地","小野下ノ町100番地","中川北山町46番地","中川北山町46番地","雲ケ畑中畑町176番地","雲ケ畑中畑町176番地","雲ケ畑中畑町176番地","岩倉中町403番地","八瀬秋元町578番地","大原来迎院町10番地の2","静市市原町36番地の3","花脊大布施町196番地","久多宮の町3番地","久多宮の町3番地","久世大薮町62","梅ケ畑奥殿町26番地1","嵯峨樒原宮ノ上町2－5","京北周山町上寺田1-1","京北周山町上寺田1-1","京北周山町上寺田1-1","京北周山町上寺田1-1","京北周山町上寺田1-1","京北周山町上寺田1-1","淀池上町131番地の1","淀池上町131番地の1","淀池上町131番地の1","淀池上町131番地の1","西院西貝川町31番地","西院西貝川町31番地","西院西貝川町31番地","西院西貝川町31番地","西院西貝川町31番地","西院西貝川町31番地","西院西貝川町31番地","深草五反田町112番地","深草五反田町112番地","深草五反田町112番地","深草五反田町112番地","深草五反田町112番地","深草五反田町112番地","深草五反田町112番地","深草五反田町112番地","大宮東脇台町8番地","大宮東脇台町8番地","高野竹屋町4番地","高野竹屋町4番地","高野竹屋町4番地","高野竹屋町4番地","高野竹屋町4番地","西野様子見町1番地の2","西野様子見町1番地の2","西野様子見町1番地の2","西野様子見町1番地の2","東九条下殿田町70番地の2","東九条下殿田町70番地の2","東九条下殿田町70番地の2","東九条下殿田町70番地の2","東九条下殿田町70番地の2","東九条下殿田町70番地の2","西院西貝川町31番地","西院西貝川町31番地","西院西貝川町31番地","西院西貝川町31番地","広河原杓子屋町180番地の1","桂乾町9番地","桂乾町9番地","桂乾町9番地","桂乾町9番地","桂乾町9番地","表町578番地","表町578番地","表町578番地","表町578番地","押小路通河原町西入榎木町450番地の2","押小路通河原町西入榎木町450番地の2","押小路通河原町西入榎木町450番地の2","釜座通下立売下る東裏辻町398番地","田中西大久保町36番地","西野今屋敷町2番地の10","西野今屋敷町2番地の10","西野今屋敷町2番地の10","五条通高倉西入堺町27番地","五条通高倉西入堺町27番地","西九条菅田町4番地","西九条菅田町4番地","太秦蜂岡町36番地","太秦蜂岡町36番地","樫原佃19番地","樫原佃19番地","樫原佃19番地","樫原佃19番地","樫原佃19番地","竹田七瀬川町9-1ほか","竹田七瀬川町9-1ほか","紫野大徳寺町88番地","中川北山町48番地の2","大宮通今出川上る観世町110番地","大宮通今出川上る観世町110番地","今小路通御前西入紙屋川町870番地","岡崎円勝寺町23番地の1","鹿ケ谷上宮ノ前町37番地","鹿ケ谷上宮ノ前町37番地","岩倉幡枝町862番地","修学院大林町13番地の8","大原上野町564番地3","鞍馬貴船町5番地の2","西ノ京東中合町45番地","西ノ京東中合町45番地","西ノ京東中合町45番地","泉涌寺五葉ノ辻町13番地の2","泉涌寺五葉ノ辻町13番地の2","大塚北溝町23番地の1","大塚北溝町23番地の1","上之町13番地","上之町13番地","中堂寺北町9番地の6","吉祥院西ノ庄淵ノ西町42番地","吉祥院西ノ庄淵ノ西町42番地","久世中久世町二丁目129番地の2","久世中久世町二丁目129番地の2","嵯峨天龍寺今堀町1番地","嵯峨天龍寺今堀町1番地","梅津高畝町46番地","御室大内35番地の1","京北下中町勝山田8","桂市ノ前町12番地","桂市ノ前町12番地","松尾木ノ曽町59番地の6","大枝東新林町二丁目4番地","大枝東新林町二丁目4番地","大枝東新林町二丁目4番地","南浜町273番地の2","淀池上町197番地","淀池上町197番地","淀池上町197番地","桃山町山ノ下44番地の5","久我森の宮町14-27","向島四ッ谷池7番地の10","向島四ッ谷池7番地の10","花脊八桝町1番地の1","花脊八桝町1番地の1","下鴨北園町86番地の6","西野今屋敷町2番地の10","上鳥羽塔ノ森下開ノ内94-4","上鳥羽塔ノ森下開ノ内94-4","上鳥羽塔ノ森下開ノ内94-4","上鳥羽塔ノ森下開ノ内94-4","上鳥羽塔ノ森下開ノ内94-4","上鳥羽塔ノ森下開ノ内94-4","西九条菅田町4番地","横大路千両松町148番地の1","横大路千両松町","横大路千両松町","小山西元町34番地","西ノ京中御門東町49番地","西ノ京中御門東町49番地","西ノ京中御門東町49番地","西ノ京中御門東町49番地","花園天授ケ岡町3番地","花園天授ケ岡町3番地","花園天授ケ岡町3番地","太秦蜂岡町36番地","太秦蜂岡町36番地","中川北山町46番地","京都御苑内ほか","今小路通御前通西入紙屋川町870番地","下河原高台寺門前下河原町526-1","上鳥羽勧進橋町","花園内畑町","嵯峨五島町1番地の19","梅津提上町","中島宮の前町9番地","西賀茂宮ノ谷1番地の2","修学院丸子青良ケ谷2番地","久多下ノ町410番地","中立売通油小路東入甲斐守町100","上賀茂前田町17番地の3","上賀茂前田町17番地の3","上賀茂前田町17番地の3","高野西開町34番地の3","高野西開町34番地の3","高野西開町34番地の3","高野西開町34番地の3","高野西開町34番地の3","小野弓田町3番地","小野弓田町3番地","小野弓田町3番地","小野弓田町3番地","小野弓田町3番地","小野弓田町3番地","西九条森本町50番地","西九条森本町50番地","西院西貝川町57番地1","樫原秤谷町37番地","樫原秤谷町37番地","樫原秤谷町37番地","樫原秤谷町37番地","樫原秤谷町37番地","横大路千両松町447番地","横大路千両松町447番地","横大路千両松町447番地","横大路千両松町447番地","横大路千両松町447番地","横大路千両松町447番地","横大路千両松町447番地","西九条森本町62番地1","西九条森本町62番地1","西九条森本町62番地1","西九条森本町62番地1","西九条森本町62番地1","西九条森本町37番地","静市市原町","静市市原町","静市市原町","静市市原町","静市市原町","静市市原町","静市市原町","静市市原町","静市市原町","静市市原町","梅ケ畑高鼻町27番地","梅ケ畑高鼻町27番地","梅ケ畑高鼻町27番地","梅ケ畑高鼻町27番地","梅ケ畑高鼻町27番地","梅ケ畑高鼻町27番地","梅ケ畑高鼻町27番地","梅ケ畑高鼻町27番地","梅ケ畑高鼻町27番地","梅ケ畑高鼻町27番地","梅ケ畑高鼻町27番地","梅ケ畑高鼻町27番地","横大路千両松町447番地","横大路千両松町447番地","横大路千両松町447番地","横大路八反田29番地","横大路八反田29番地","横大路八反田29番地","横大路八反田29番地","横大路八反田29番地","横大路八反田29番地","横大路八反田29番地","醍醐上山田１","醍醐上山田１","醍醐上山田1","醍醐上山田1","醍醐上山田1","醍醐上山田1","東野東山","醍醐陀羅谷","醍醐上山田1","醍醐上山田1","東野東山","淀水垂町73","淀水垂町73","淀水垂町73","淀水垂町73","横大路千両松町","横大路千両松町","横大路千両松町","下清蔵口町132番地","下清蔵口町132番地","横大路千両松町447番地","横大路千両松町447番地","横大路千両松町447番地","横大路千両松町447番地","横大路千両松町447番地","大枝沓掛町","大枝沓掛町","大枝沓掛町","大枝沓掛町","大枝沓掛町","大枝沓掛町","大枝沓掛町","大枝沓掛町","大枝沓掛町","石田西ノ坪2番地の18","石田西ノ坪2番地の18","石田西ノ坪2番地の18","石田西ノ坪2番地の18","石田西ノ坪2番地の18","石田西ノ坪2番地の18","石田西ノ坪2番地の18","石田西ノ坪2番地の18","石田西ノ坪2番地の18","石田西ノ坪2番地の18","石田西ノ坪2番地の18","梅ケ旗向ノ地町27番地1ほか","嵯峨釈迦堂大門町35","嵯峨釈迦堂大門町35","西院西貝川町31番地","大宮東脇台町8番地","大宮東脇台町8番地","出雲路立テ本町86-1","押小路通堀川西入二条城町541番地","東堀川通木津屋橋下る御方紺屋町1番1","嵯峨釣殿町22番地の2","嵯峨釣殿町22番地の2","西院西貝川町31番地","大原野東境谷町三丁目","毛利町44番地の3","淀水垂町733番地1","深草泓ノ壷町14-4","紫野北舟岡町42番地","壬生下溝町44番地の3","今熊野日吉町10番地の3","今熊野日吉町10番地の3","今熊野日吉町10番地の3","竹田藁屋町4番地の1","竹田藁屋町4番地の1","清水四丁目161番地の5","清水四丁目161番地の5","清水四丁目161番地の5","清水四丁目161番地の5","清水四丁目161番地の5","嵯峨天龍寺造路町31番地の1","嵯峨天龍寺造路町31番地の1","浄土寺石橋町62番地","浄土寺石橋町62番地","梅ケ畑栂尾町1番地の1","祇園町北側","西ノ京円町42番地の1","西ノ京星池町4-20ほか","西九条島町66番地の1","西九条西柳の内町91番地の2","吉祥院西ノ庄門口町29","太秦上ノ段町19番地","壬生淵田町2-1ほか","西京極西大丸町80番地","花園寺ノ内町5番地ほか","川島有栖川町52","嵐山宮ノ前町47番地の3","石田森東町46","竹田向代町110番地の1","上野御所ノ内町16番地10ほか","西ノ京下合町38番地4","安朱棧敷町200番地の2","御陵原西町12番地の12","小野鐘付田町120番地の2","御陵鴨戸町51番地の7","久世上久世町110番地の3","久世高田町126番地","嵯峨天龍寺広道町20番地の7","太秦下刑部町9番地の2","太秦下刑部町9番地の2","桂野里町41-45","川島北裏町116-1","壬生天池町5－2ほか","石田森東町46","川端通四条上る川端町181番地","東洞院通六角下る御射山町ほか","河原町通今出川上る青龍町","御池通高倉西入高宮町","岩倉大鷺町","松ケ崎井手ケ海道町","椥辻池尻町14番地の4","東野片下リ町27-4","醍醐高畑町1番地の36","小稲荷町87番地","川端町4番地13","上ノ町1番地10","郷ノ町北部5番地","屋形町20番地1","小稲荷町39番地","衣笠金閣寺町","花園妙心寺町35番地","北大路橋西詰北側","大徳寺通北大路上る西側","大谷大学グランド北","一乗寺花ノ木町","大原野南春日町　大原野神社駐車場内","出町橋西詰北側","荒神橋西詰南側","北野天満宮前西側","寺町丸太町西北角","本隆寺北","二条児童公園内","堀川通中立売下る東側","今出川千本東入北側","東一条川端南東角","岡崎最勝寺町","吉田本町","川端丸太町西南角","大原寂光院駐車場内","岡崎最勝寺町","銀閣寺橋西詰北側","JR嵯峨嵐山駅南側","出町柳駅前公園内","大原野村町","烏丸御池南西角","六角新京極東入","錦小路東洞院東入南側","姉小路寺町東入","新京極公園内","蛸薬師新京極東入","押小路神泉苑通","千本釈迦堂南側","円山公園内","円山公園内","京都国立博物館南西","建仁寺西門前","円山公園内","清水寺境内南西部","川端四条上ル東側","三十三間堂東側","五条通清水坂西","円山公園内","白川東大路西入","蛸薬師木屋町","東本願寺南東角","四条大宮駅南広場内","七条堀川西入北側","七本松七条北東角","花屋町新町東入南側","京北井戸町　常照皇寺駐車場内","清凉寺西門南側","金鈴橋東詰南","小倉山二尊院総門南100m","高雄橋南詰西150m","龍安寺御陵ノ下町","嵐山公園中ノ島内","渡月橋北詰西350m","渡月小橋南詰西100m","京北上黒田町　上黒田バス停前","桃山御陵参道野坂通下ル","東柳町　南浜児童館子楽園内","醍醐三宝院駐車場内","嵐山公園中ノ島内","祗園石段下北","霊山観音駐車場西","御室仁和寺駐車場入口西側","渡月橋北詰西500m　亀山公園入口","京阪三条駅前広場南東部","五条児童公園内","京都バス大原バスターミナル内","京北中地町　中地ロードパーク内","銀閣寺11番","銀閣寺11番","修学院辻ノ田町13番地の1","修学院辻ノ田町13番地の1","修学院辻ノ田町13番地の1","教業町","大和大路通四条上る二筋目東入末吉町77番6","大原大長瀬町179番地の2","大宮通花屋町上る堀之上町540番地","大宮通花屋町上る堀之上町540番地","大宮通花屋町上る堀之上町540番地","久世大築町54番地の1","上鳥羽山ノ本町","京北上弓削町段上ノ下","京北上弓削町段上ノ下","京北上弓削町段上ノ下","京北上弓削町段上ノ下","京北上弓削町段上ノ下","京北中地町蛸谷口92","御室堅町19番","御室堅町19番","北嵯峨落久保町8-2","西院春日町3番4","太秦桂ケ原町9番地1","太秦桂ケ原町9番地1","太秦桂ケ原町9番地1","太秦桂ケ原町9番地1","太秦桂ケ原町9番地1","太秦桂ケ原町9番地1","太秦桂ケ原町9番地1","京北周山町城山54番5","大原野東境谷町二丁目5番地の11","大原野東境谷町二丁目5番地の11","大原野東境谷町二丁目5番地の11","大原野東境谷町二丁目5番地の11","大原野東境谷町二丁目5番地の11","大原野東境谷町二丁目5番地の11","大原野東境谷町二丁目5番地の11","納所北城堀10番地の1","久我御旅町3番地の3","御駕籠町91番地","御駕籠町91番地","御駕籠町91番地","下鳥羽西芹川町","上鳥羽仏現寺町11番地","上鳥羽仏現寺町11番地","上鳥羽仏現寺町11番地","京北周山町下台2-1","京北周山町下台2-1","壬生下溝町44番地の3","壬生下溝町44番地の3","大宮東脇台町8番地","小山南上総町1-1","壬生東高田町1-2","下鴨宮河町58-2","御陵大枝山町四丁目30番地","御陵大枝山町四丁目30番地","御陵大枝山町四丁目30番地","吉祥院石原東之口町2番地","西野山階町35番地","西野山階町35番地","西野山階町35番地","山田上ノ町9番1","山田上ノ町9番1","山田上ノ町9番1","山田上ノ町9番1","山田上ノ町9番2","山田上ノ町9番3","西九条森本町83番地1","下鴨宮河町58-2","下鴨宮河町58-2","下鴨宮河町58-2","下鴨宮河町58-2","西九条北ノ内町","寺町通御池上る上本能寺前町488番地","太秦京ノ道町13番地の2","朱雀分木町80番地","朱雀分木町80番地","朱雀分木町80番地","岡崎法勝寺町岡崎公園内","岡崎法勝寺町岡崎公園内","寺町通二条下る榎木町450番地1","寺町通御池上る上本能寺前町488番地","京北矢代中町馬場谷道ノ上32番1他","粟田口鳥居町2番地の1","西木屋町通上ノ口上る梅湊町83番地の1","粟田口鳥居町2番地の1","松ケ崎東池ノ内町ほか","松ケ崎東池ノ内町ほか","吉祥院石原東之口町2番地","吉祥院石原東之口町2番地","吉祥院石原東之口町2番地","吉祥院石原東之口町2番地","深草石峰寺山町","深草五反田町112番地","深草五反田町112番地","深草神明講谷町２番地の１","深草神明講谷町２番地の１","深草神明講谷町２番地の１","太秦安井柳通町14番地の1","醍醐陀羅谷１番地の１３８他","醍醐陀羅谷１番地の１３８他","醍醐陀羅谷１番地の１３８他","醍醐陀羅谷１番地の１３８他","横大路八反田29番地","横大路八反田29番地","横大路八反田29番地","横大路八反田29番地","横大路八反田29番地","横大路八反田29番地","横大路八反田29番地","横大路八反田29番地","横大路八反田29番地","吉祥院新田下ノ向町","聖護院円頓美町46番地の2","深草五反田町112番地","上花山旭山町19番地の3","上花山旭山町19番地の3","川島五反長町１８番地の２","川島五反長町１８番地の２","川島五反長町１８番地の２","西院西貝川町31番地","東九条院町9番地の2　等","東九条西山王町32番地","東九条室町49番地","吉祥院石原東之口町2番地","大宮西脇台町１７番地の２","大宮西脇台町１７番地の２","大宮西脇台町１７番地の２","紫野西舟岡町２","紫野西舟岡町２","紫野西舟岡町２","紫野西舟岡町２","紫野西舟岡町２","紫野西舟岡町２","紫野西舟岡町２","紫野西舟岡町２","紫野西舟岡町２","紫野西舟岡町２","紫野西舟岡町２","久我御旅町7番19","久我御旅町7番19","東九条上殿田町他","東九条西山王町","下本能寺前町","鷹峯旧土居町4-3","紫野上鳥田町30番地","岡崎法勝寺町岡崎公園内","二条通堀川西入二条城町541番地","聖護院円頓美町46番地の2","聖護院円頓美町46番地の2","京北中地町蛸谷口","京北比賀江町院谷ほか","西院日照町","勧修寺東金ケ崎","桃山町大蔵地内","桃山町大蔵地内","桃山町大蔵地内","桃山町大蔵地内","桃山町大蔵地内","桃山町大蔵地内","吉祥院新田下ノ向町","大枝沓掛町14-26,14-27,14-197","勧修寺閑林寺83番地8","吉祥院石原東之口町2番地","吉祥院石原東之口町2番地","吉祥院石原東之口町2番地","朱雀分木町80番地","朱雀分木町80番地","志摩市大王町船越231番地","志摩市大王町船越231番地","志摩市大王町船越231番地","志摩市大王町船越231番地","粟田口鳥居町2番地の1","上花山旭山町19番地の3","上花山旭山町19番地の3","上花山旭山町19番地の3","上花山旭山町19番地の3","紫野西舟岡町2","修学院沖殿町1番地","紫野下築山町20番地","二条通堀川西入二条城町541番地","二条通堀川西入二条城町541番地","二条通堀川西入二条城町541番地","二条通堀川西入二条城町541番地","二条通堀川西入二条城町541番地","二条通堀川西入二条城町541番地","二条通堀川西入二条城町541番地","二条通堀川西入二条城町541番地","二条通堀川西入二条城町541番地","二条通堀川西入二条城町541番地","二条通堀川西入二条城町541番地","二条通堀川西入二条城町541番地","二条通堀川西入二条城町541番地","二条通堀川西入二条城町541番地","二条通堀川西入二条城町541番地","二条通堀川西入二条城町541番地","二条通堀川西入二条城町541番地","二条通堀川西入二条城町541番地","二条通堀川西入二条城町541番地","二条通堀川西入二条城町541番地","二条通堀川西入二条城町541番地","二条通堀川西入二条城町541番地","二条通堀川西入二条城町541番地","二条通堀川西入二条城町541番地","朱雀分木町80番地","御陵池堤町28-3","二条通堀川西入二条城町541番地","二条通堀川西入二条城町541番地","二条通堀川西入二条城町541番地","二条通堀川西入二条城町541番地","二条通堀川西入二条城町541番地","二条通堀川西入二条城町541番地","京北塔町隠谷１番地","壬生東土居ノ内町 ２０番地の１","壬生東高田町１番地の２０","壬生東高田町１番地の２０","壬生東高田町１番地の２０","壬生東高田町１番地の２０","壬生東高田町１番地の２０","上桂森下町25番地の1","下之町57-1","下之町7-55、7-66、7-90","大枝塚原町4番地の63","東九条東岩本町31","御幸町通仏光寺下る橘町437","岡崎法勝寺町岡崎公園内","岡崎法勝寺町岡崎公園内","竹田藁屋町4番地の1","松ケ崎東池ノ内町ほか","松ケ崎東池ノ内町ほか","京北比賀江町院谷ほか","西京極新明町29番地","西京極新明町29番地","西京極新明町29番地","西京極新明町29番地"

    ]

    results = geocode_many(addresses)

    # ターミナルでは流れやすいので CSV に保存する
    out_path = "geocode_results.csv"
    ok_count = 0
    ng_count = 0

    with open(out_path, "w", newline="", encoding="utf-8-sig") as f:
        writer = csv.writer(f)
        writer.writerow(["address", "lat", "lng", "status", "error"])

        for r in results:
            if r["status"] == "OK":
                writer.writerow([r["address"], r["lat"], r["lng"], r["status"], ""])
                ok_count += 1
            else:
                writer.writerow([r["address"], "", "", r["status"], r.get("error", "")])
                ng_count += 1

    print(f"saved: {out_path} (OK={ok_count}, NG={ng_count}, total={len(results)})")
